import{r as x,j as e,u as de,d as re,D as xe,E as ce}from"./index-c208d5f4.js";const W=x.memo(({party:s})=>{var l;return e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h1",{className:"text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-amber-400 to-orange-400 mb-4",children:"Campaign Lobby"}),e.jsx("div",{className:"w-24 h-1 bg-gradient-to-r from-amber-400 to-orange-400 mx-auto rounded-full mb-4"}),e.jsx("h2",{className:"text-2xl font-semibold text-slate-100 mb-2",children:s.name}),e.jsx("p",{className:"text-slate-400 mb-4",children:s.description}),e.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[e.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${s.campaignType==="ai-assist"?"bg-amber-500/20 text-amber-300 border border-amber-500/30":"bg-slate-600/20 text-slate-300 border border-slate-500/30"}`,children:s.campaignType==="ai-assist"?"ü§ñ AI Assist":"‚úçÔ∏è Manual Campaign"}),e.jsxs("div",{className:"text-slate-400",children:[(l=s.members)==null?void 0:l.filter(a=>a!==s.dmId).length," / ",s.maxPlayers," Players"]})]})]})})});W.displayName="LobbyHeader";const oe=W,q=x.memo(({memberId:s,character:l,isCurrentUser:a,getUsername:t,getCharacterStatus:d,getStatusColor:b,getStatusIcon:p,onViewCharacterSheet:N})=>{const c=d(l);return e.jsxs("div",{className:`fantasy-card ${a?"ring-2 ring-amber-500/50":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-slate-600 to-slate-700 rounded-full flex items-center justify-center mr-3",children:e.jsx("span",{className:"text-slate-300 font-semibold",children:t(s).charAt(0).toUpperCase()})}),e.jsx("div",{children:e.jsx("h3",{className:"font-semibold text-slate-100",children:t(s)})})]}),e.jsxs("div",{className:`text-sm font-medium ${b(c)}`,children:[p(c)," ",c]})]}),l&&e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-semibold text-slate-100",children:l.name}),e.jsx("button",{onClick:()=>N(l),className:"text-xs bg-blue-600 hover:bg-blue-700 text-white px-2 py-1 rounded transition-colors",children:"Manage"})]}),e.jsxs("p",{className:"text-sm text-slate-400",children:[l.race," ",l.class," ‚Ä¢ Level ",l.level]}),l.background&&e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:l.background}),l.alignment&&e.jsx("p",{className:"text-xs text-slate-500",children:l.alignment}),(l.age||l.height||l.weight)&&e.jsx("div",{className:"mt-2 pt-2 border-t border-slate-600/30",children:e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[l.age&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Age:"}),e.jsx("div",{className:"text-slate-200",children:l.age})]}),l.height&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Height:"}),e.jsx("div",{className:"text-slate-200",children:l.height})]}),l.weight&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Weight:"}),e.jsx("div",{className:"text-slate-200",children:l.weight})]})]})}),(l.eyes||l.skin||l.hair)&&e.jsx("div",{className:"mt-2 pt-2 border-t border-slate-600/30",children:e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[l.eyes&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Eyes:"}),e.jsx("div",{className:"text-slate-200",children:l.eyes})]}),l.skin&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Skin:"}),e.jsx("div",{className:"text-slate-200",children:l.skin})]}),l.hair&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Hair:"}),e.jsx("div",{className:"text-slate-200",children:l.hair})]})]})}),(l.personality||l.ideals||l.bonds||l.flaws)&&e.jsx("div",{className:"mt-2 pt-2 border-t border-slate-600/30",children:e.jsxs("div",{className:"space-y-1 text-xs",children:[l.personality&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400 font-medium",children:"Personality:"}),e.jsx("div",{className:"text-slate-200 text-xs mt-1 line-clamp-2",children:l.personality})]}),l.ideals&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400 font-medium",children:"Ideals:"}),e.jsx("div",{className:"text-slate-200 text-xs mt-1 line-clamp-2",children:l.ideals})]}),l.bonds&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400 font-medium",children:"Bonds:"}),e.jsx("div",{className:"text-slate-200 text-xs mt-1 line-clamp-2",children:l.bonds})]}),l.flaws&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400 font-medium",children:"Flaws:"}),e.jsx("div",{className:"text-slate-200 text-xs mt-1 line-clamp-2",children:l.flaws})]})]})})]})})]})});q.displayName="PartyMemberCard";const me=q,z=x.memo(({campaignMap:s,mapTitle:l,isDM:a,tileTypes:t,getTileHasSubMap:d,handleTileRightClick:b,onEditMap:p,onViewCharacters:N})=>!s||s.length===0?null:e.jsxs("div",{className:"fantasy-card mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-100",children:l}),a&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:p,className:"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300 text-sm",children:"üó∫Ô∏è Edit Map"}),e.jsx("button",{onClick:N,className:"bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300 text-sm",children:"üìã View Characters"})]})]}),e.jsx("div",{className:"bg-slate-800/50 border border-slate-600/50 rounded-lg p-4 overflow-x-auto",children:e.jsx("div",{className:"inline-block",children:s.map((c,i)=>e.jsx("div",{className:"flex",children:c.map((o,h)=>{var f,w,y;return e.jsxs("div",{className:`w-8 h-8 border border-slate-600 flex items-center justify-center text-xs relative ${((f=t[o])==null?void 0:f.color)||"bg-slate-700"}`,title:`${h}, ${i}: ${((w=t[o])==null?void 0:w.name)||"Unknown"}${d(h,i)?" (Has sub-map)":""}`,onContextMenu:m=>b(h,i,m),children:[((y=t[o])==null?void 0:y.symbol)||"‚¨ú",d(h,i)&&e.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-purple-500 rounded-full flex items-center justify-center text-[8px] text-white",children:"üìç"})]},`${h}-${i}`)})},i))})}),e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"text-xs text-slate-400 text-center sm:text-left",children:["üí° ",e.jsx("strong",{children:"Tip:"})," Right-click on any tile to create or edit sub-maps (detailed areas within tiles)"]}),e.jsx("div",{className:"text-xs text-slate-400 text-center sm:text-right",children:"üìç Purple pins indicate tiles with sub-maps"})]})]}));z.displayName="CampaignMapDisplay";const he=z;function je({character:s,onClose:l}){return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"fantasy-card max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-slate-100",children:["Character Sheet: ",s.name]}),e.jsx("button",{onClick:l,className:"text-slate-400 hover:text-slate-200 text-2xl",children:"√ó"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100 mb-3",children:"Basic Information"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Name:"})," ",e.jsx("span",{className:"text-slate-200",children:s.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Race:"})," ",e.jsx("span",{className:"text-slate-200",children:s.race})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Class:"})," ",e.jsx("span",{className:"text-slate-200",children:s.class})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Level:"})," ",e.jsx("span",{className:"text-slate-200",children:s.level})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Background:"})," ",e.jsx("span",{className:"text-slate-200",children:s.background})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Alignment:"})," ",e.jsx("span",{className:"text-slate-200",children:s.alignment})]})]})]}),e.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100 mb-3",children:"Ability Scores"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Strength:"})," ",e.jsx("span",{className:"text-slate-200",children:s.strength})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Dexterity:"})," ",e.jsx("span",{className:"text-slate-200",children:s.dexterity})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Constitution:"})," ",e.jsx("span",{className:"text-slate-200",children:s.constitution})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Intelligence:"})," ",e.jsx("span",{className:"text-slate-200",children:s.intelligence})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Wisdom:"})," ",e.jsx("span",{className:"text-slate-200",children:s.wisdom})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Charisma:"})," ",e.jsx("span",{className:"text-slate-200",children:s.charisma})]})]})]}),(s.age||s.height||s.weight||s.eyes||s.skin||s.hair)&&e.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100 mb-3",children:"Physical Description"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[s.age&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Age:"})," ",e.jsx("span",{className:"text-slate-200",children:s.age})]}),s.height&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Height:"})," ",e.jsx("span",{className:"text-slate-200",children:s.height})]}),s.weight&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Weight:"})," ",e.jsx("span",{className:"text-slate-200",children:s.weight})]}),s.eyes&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Eyes:"})," ",e.jsx("span",{className:"text-slate-200",children:s.eyes})]}),s.skin&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Skin:"})," ",e.jsx("span",{className:"text-slate-200",children:s.skin})]}),s.hair&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Hair:"})," ",e.jsx("span",{className:"text-slate-200",children:s.hair})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[(s.personality||s.ideals||s.bonds||s.flaws)&&e.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100 mb-3",children:"Character Traits"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[s.personality&&e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-400 font-medium",children:"Personality:"}),e.jsx("div",{className:"text-slate-200",children:s.personality})]}),s.ideals&&e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-400 font-medium",children:"Ideals:"}),e.jsx("div",{className:"text-slate-200",children:s.ideals})]}),s.bonds&&e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-400 font-medium",children:"Bonds:"}),e.jsx("div",{className:"text-slate-200",children:s.bonds})]}),s.flaws&&e.jsxs("div",{children:[e.jsx("div",{className:"text-slate-400 font-medium",children:"Flaws:"}),e.jsx("div",{className:"text-slate-200",children:s.flaws})]})]})]}),s.backstory&&e.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100 mb-3",children:"Backstory"}),e.jsx("div",{className:"text-sm text-slate-200 leading-relaxed",children:s.backstory})]}),s.equipment&&s.equipment.length>0&&e.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100 mb-3",children:"Equipment"}),e.jsx("ul",{className:"space-y-1 text-sm",children:s.equipment.map((a,t)=>e.jsxs("li",{className:"text-slate-200",children:["‚Ä¢ ",a]},t))})]}),s.spells&&s.spells.length>0&&e.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100 mb-3",children:"Spells"}),e.jsx("ul",{className:"space-y-1 text-sm",children:s.spells.map((a,t)=>e.jsxs("li",{className:"text-slate-200",children:["‚Ä¢ ",a]},t))})]})]})]})]})}):null}function be({partyCharacters:s,getUsername:l,onClose:a}){return!s||s.length===0?null:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"fantasy-card max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-100",children:"All Party Character Sheets"}),e.jsx("button",{onClick:a,className:"text-slate-400 hover:text-slate-200 text-2xl",children:"√ó"})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:s.map(t=>e.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:t.name}),e.jsx("span",{className:"text-sm text-slate-400",children:l(t.userId)})]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Race:"})," ",e.jsx("span",{className:"text-slate-200",children:t.race})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Class:"})," ",e.jsx("span",{className:"text-slate-200",children:t.class})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Level:"})," ",e.jsx("span",{className:"text-slate-200",children:t.level})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Background:"})," ",e.jsx("span",{className:"text-slate-200",children:t.background})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"STR:"})," ",e.jsx("span",{className:"text-slate-200",children:t.strength})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"DEX:"})," ",e.jsx("span",{className:"text-slate-200",children:t.dexterity})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"CON:"})," ",e.jsx("span",{className:"text-slate-200",children:t.constitution})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"INT:"})," ",e.jsx("span",{className:"text-slate-200",children:t.intelligence})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"WIS:"})," ",e.jsx("span",{className:"text-slate-200",children:t.wisdom})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"CHA:"})," ",e.jsx("span",{className:"text-slate-200",children:t.charisma})]})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsxs("span",{children:[e.jsx("span",{className:"text-slate-400",children:"HP:"})," ",e.jsxs("span",{className:"text-slate-200",children:[t.hp,"/",t.maxHp]})]}),e.jsxs("span",{children:[e.jsx("span",{className:"text-slate-400",children:"AC:"})," ",e.jsx("span",{className:"text-slate-200",children:t.ac})]})]}),t.backstory&&e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"text-slate-400 font-medium text-xs mb-1",children:"Backstory:"}),e.jsx("div",{className:"text-slate-200 text-xs leading-relaxed line-clamp-3",children:t.backstory})]})]})]},t.id))})]})})}function pe({show:s,mapTitle:l,setMapTitle:a,mapSize:t,setMapSize:d,selectedTool:b,setSelectedTool:p,selectedTile:N,setSelectedTile:c,tileTypes:i,campaignMap:o,handleTileMouseDown:h,handleTileMouseEnter:f,handleTileMouseUp:w,handleTileRightClick:y,getTileHasSubMap:m,handleClearMap:j,handleSaveMap:C,handleResizeMap:v,onClose:M}){var k;return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"fantasy-card max-w-6xl w-full max-h-[95vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-100",children:"Grid-Based Map Editor"}),e.jsx("button",{onClick:M,className:"text-slate-400 hover:text-slate-200 text-2xl",children:"√ó"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-4",children:[e.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100 mb-3",children:"Map Settings"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-200 mb-2",children:"Map Title"}),e.jsx("input",{type:"text",value:l,onChange:r=>a(r.target.value),className:"w-full bg-slate-700/50 border border-slate-600/50 text-slate-200 px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500/50 focus:border-amber-500/50",placeholder:"Enter map title..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-200 mb-2",children:"Map Size"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Width"}),e.jsx("input",{type:"number",min:"5",max:"30",value:t.width,onChange:r=>{d(n=>({...n,width:parseInt(r.target.value)})),v()},className:"w-full bg-slate-700/50 border border-slate-600/50 text-slate-200 px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500/50 focus:border-amber-500/50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Height"}),e.jsx("input",{type:"number",min:"5",max:"20",value:t.height,onChange:r=>{d(n=>({...n,height:parseInt(r.target.value)})),v()},className:"w-full bg-slate-700/50 border border-slate-600/50 text-slate-200 px-3 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500/50 focus:border-amber-500/50"})]})]})]})]})]}),e.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100 mb-3",children:"Tools"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:()=>p("draw"),className:`w-full text-left px-3 py-2 rounded-lg transition-colors ${b==="draw"?"bg-amber-500/20 text-amber-300 border border-amber-500/30":"bg-slate-700/30 text-slate-300 hover:bg-slate-700/50"}`,children:"‚úèÔ∏è Draw"}),e.jsx("button",{onClick:()=>p("erase"),className:`w-full text-left px-3 py-2 rounded-lg transition-colors ${b==="erase"?"bg-red-500/20 text-red-300 border border-red-500/30":"bg-slate-700/30 text-slate-300 hover:bg-slate-700/50"}`,children:"üóëÔ∏è Erase"})]})]}),e.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100 mb-3",children:"Tile Palette"}),e.jsx("div",{className:"grid grid-cols-3 gap-2 max-h-96 overflow-y-auto",children:Object.entries(i).map(([r,n])=>e.jsxs("button",{onClick:()=>c(r),className:`p-2 rounded-lg border transition-colors ${N===r?"border-amber-500 bg-amber-500/20":"border-slate-600 bg-slate-700/30 hover:border-slate-500"}`,children:[e.jsx("div",{className:`w-6 h-6 ${n.color} rounded flex items-center justify-center text-xs mx-auto mb-1`,children:n.symbol}),e.jsx("div",{className:"text-xs text-slate-300 truncate",children:n.name})]},r))})]}),e.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100 mb-3",children:"Actions"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:j,className:"w-full bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300",children:"üóëÔ∏è Clear Map"}),e.jsx("button",{onClick:C,className:"w-full bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300",children:"üíæ Save Map"})]})]})]}),e.jsxs("div",{className:"lg:col-span-3",children:[e.jsxs("div",{className:"bg-slate-800/50 border border-slate-600/50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Map Canvas"}),e.jsxs("div",{className:"text-sm text-slate-400",children:[t.width," √ó ",t.height," grid"]})]}),e.jsx("div",{className:"overflow-auto",children:e.jsx("div",{className:"inline-block",children:o.map((r,n)=>e.jsx("div",{className:"flex",children:r.map(($,g)=>{var S,E,D;return e.jsxs("button",{onMouseDown:()=>h(g,n),onMouseEnter:()=>f(g,n),onMouseUp:w,onContextMenu:A=>y(g,n,A),className:`w-10 h-10 border border-slate-600 flex items-center justify-center text-sm transition-colors hover:border-amber-400 relative select-none ${((S=i[$])==null?void 0:S.color)||"bg-slate-700"}`,title:`${g}, ${n}: ${((E=i[$])==null?void 0:E.name)||"Unknown"}${m(g,n)?" (Right-click for sub-map)":" (Right-click to create sub-map)"}`,children:[((D=i[$])==null?void 0:D.symbol)||"‚¨ú",m(g,n)&&e.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-purple-500 rounded-full flex items-center justify-center text-[10px] text-white",children:"üìç"})]},`${g}-${n}`)})},n))})})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 sm:grid-cols-2 gap-4 text-xs text-slate-400",children:[e.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-3",children:[e.jsx("div",{className:"font-semibold text-slate-300 mb-1",children:"Current Status"}),e.jsxs("div",{children:["Tool: ",e.jsx("span",{className:"text-amber-300",children:b==="draw"?"‚úèÔ∏è Draw":"üóëÔ∏è Erase"})]}),e.jsxs("div",{children:["Tile: ",e.jsx("span",{className:"text-amber-300",children:(k=i[N])==null?void 0:k.name})]})]}),e.jsxs("div",{className:"bg-slate-700/30 rounded-lg p-3",children:[e.jsx("div",{className:"font-semibold text-slate-300 mb-1",children:"Instructions"}),e.jsx("div",{children:"‚Ä¢ Click or drag to place/remove"}),e.jsx("div",{children:"‚Ä¢ Right-click for sub-maps"}),e.jsx("div",{children:"‚Ä¢ Purple pins = sub-maps"})]})]})]})]})]})}):null}function ge({show:s,selectedSubMapTile:l,currentSubMap:a,setCurrentSubMap:t,selectedTool:d,setSelectedTool:b,selectedTile:p,setSelectedTile:N,tileTypes:c,handleSubMapTileMouseDown:i,handleSubMapTileMouseEnter:o,handleTileMouseUp:h,handleSaveSubMap:f,handleClearSubMap:w,onClose:y}){return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"fantasy-card max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-slate-100",children:["Sub-Map Editor - Tile (",l.x,", ",l.y,")"]}),e.jsx("button",{onClick:y,className:"text-slate-400 hover:text-slate-200 text-2xl",children:"√ó"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-slate-800/50 border border-slate-600/50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Sub-Map (8x8)"}),e.jsx("button",{onClick:w,className:"px-3 py-1 bg-red-600 hover:bg-red-700 text-white rounded text-sm",children:"Clear"})]}),e.jsx("div",{className:"grid grid-cols-8 gap-1 mb-4",children:a.map((m,j)=>m.map((C,v)=>{var M,k,r;return e.jsx("button",{onMouseDown:()=>i(v,j),onMouseEnter:()=>o(v,j),onMouseUp:h,className:`w-12 h-12 border border-slate-600 flex items-center justify-center text-lg transition-colors hover:border-amber-400 select-none ${((M=c[C])==null?void 0:M.color)||"bg-slate-700"}`,title:`${v}, ${j}: ${((k=c[C])==null?void 0:k.name)||"Empty"}`,children:((r=c[C])==null?void 0:r.symbol)||"‚¨ú"},`sub-${v}-${j}`)}))})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-slate-800/50 border border-slate-600/50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100 mb-3",children:"Tools"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:()=>b("draw"),className:`w-full px-3 py-2 rounded text-sm font-medium transition-colors ${d==="draw"?"bg-amber-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:"‚úèÔ∏è Draw"}),e.jsx("button",{onClick:()=>b("erase"),className:`w-full px-3 py-2 rounded text-sm font-medium transition-colors ${d==="erase"?"bg-amber-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:"üóëÔ∏è Erase"})]})]}),e.jsxs("div",{className:"bg-slate-800/50 border border-slate-600/50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100 mb-3",children:"Tile Types"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-80 overflow-y-auto",children:Object.entries(c).map(([m,j])=>e.jsxs("button",{onClick:()=>N(m),className:`p-2 rounded text-sm font-medium transition-colors flex items-center gap-2 ${p===m?"bg-amber-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:[e.jsx("span",{className:"text-lg",children:j.symbol}),e.jsx("span",{className:"truncate",children:j.name})]},m))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:f,className:"flex-1 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded font-medium",children:"Save Sub-Map"}),e.jsx("button",{onClick:y,className:"px-4 py-2 bg-slate-600 hover:bg-slate-700 text-white rounded font-medium",children:"Cancel"})]})]})]})]})}):null}function we(){const s=de(),{user:l,loading:a}=re(),{party:t,partyCharacters:d,partyMemberProfiles:b,userCharacter:p,isDM:N,loading:c,nonDMMembers:i,getUsername:o,getCharacterStatus:h,getStatusColor:f,getStatusIcon:w}=xe(),{showMapEditor:y,campaignMap:m,mapTitle:j,mapSize:C,selectedTile:v,selectedTool:M,showSubMapEditor:k,selectedSubMapTile:r,subMaps:n,currentSubMap:$,tileTypes:g,setShowMapEditor:S,setShowSubMapEditor:E,setMapTitle:D,setMapSize:A,setSelectedTile:I,setSelectedTool:T,setCurrentSubMap:O,handleTileRightClick:H,handleSubMapTileClick:ue,handleSubMapTileMouseDown:F,handleSubMapTileMouseEnter:G,handleTileMouseUp:L,handleSaveSubMap:X,handleClearSubMap:J,getTileHasSubMap:R}=ce(),[K,Q]=x.useState(null),[Ne,B]=x.useState(!1),[ve,U]=x.useState(!1),Y=x.useCallback(()=>{t.campaignType==="manual"?t.dmId===l.uid?s(`/manual-campaign-dm/${t.id}`):s(`/manual-campaign/${t.id}`):s(`/campaign/${t.id}`)},[t,l==null?void 0:l.uid,s]),Z=x.useCallback(()=>{s(`/character-creation/${t.id}`)},[t==null?void 0:t.id,s]),V=x.useCallback(u=>{Q(u),B(!0)},[]),_=x.useCallback(()=>{S(!0)},[S]),ee=x.useCallback(()=>{U(!0)},[]),se=x.useCallback(()=>{B(!1)},[]),le=x.useCallback(()=>{U(!1)},[]),te=x.useMemo(()=>i.map(u=>{const P=d.find(ne=>ne.userId===u),ie=u===l.uid;return e.jsx(me,{memberId:u,character:P,isCurrentUser:ie,getUsername:o,getCharacterStatus:h,getStatusColor:f,getStatusIcon:w,onViewCharacterSheet:V},u)}),[i,d,l==null?void 0:l.uid,o,h,f,w,V]),ae=x.useMemo(()=>[{label:"Campaign Type:",value:t.campaignType==="ai-assist"?"AI-Assisted Storytelling":"Manual D&D Experience"},{label:"Max Players:",value:t.maxPlayers},{label:"Current Players:",value:d.filter(u=>u.userId!==t.dmId).length},{label:"Dungeon Master:",value:o(t.dmId)}],[t,d,o]);return a||c?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-amber-400 border-t-transparent mx-auto mb-4"}),e.jsx("p",{className:"text-slate-300 text-lg font-medium",children:"Loading campaign lobby..."})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:e.jsxs("div",{className:"fantasy-container",children:[e.jsx(oe,{party:t}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:te}),e.jsx(he,{campaignMap:m,mapTitle:j,isDM:N,tileTypes:g,getTileHasSubMap:R,handleTileRightClick:H,onEditMap:_,onViewCharacters:ee}),e.jsxs("div",{className:"mt-8 fantasy-card",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100 mb-4",children:"Campaign Information"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:ae.map((u,P)=>e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:u.label}),e.jsx("span",{className:"text-slate-200 ml-2",children:u.value})]},P))})]}),e.jsxs("div",{className:"mt-8 flex flex-col sm:flex-row gap-4 justify-center",children:[!p&&e.jsx("button",{onClick:Z,className:"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-300 text-lg",children:"üé≠ Create Character"}),p&&e.jsx("button",{onClick:Y,className:"bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold py-3 px-6 rounded-lg transition-all duration-300 text-lg",children:"üöÄ Start Campaign"})]}),e.jsx(je,{character:K,onClose:se}),e.jsx(be,{partyCharacters:d,getUsername:o,onClose:le}),e.jsx(pe,{show:y,mapTitle:j,setMapTitle:D,mapSize:C,setMapSize:A,selectedTool:M,setSelectedTool:T,selectedTile:v,setSelectedTile:I,tileTypes:g,campaignMap:m,handleTileMouseDown,handleTileMouseEnter,handleTileMouseUp:L,handleTileRightClick:H,getTileHasSubMap:R,handleClearMap,handleSaveMap,handleResizeMap,onClose:()=>S(!1)}),e.jsx(ge,{show:k,selectedSubMapTile:r,currentSubMap:$,setCurrentSubMap:O,selectedTool:M,setSelectedTool:T,selectedTile:v,setSelectedTile:I,tileTypes:g,handleSubMapTileMouseDown:F,handleSubMapTileMouseEnter:G,handleTileMouseUp:L,handleSaveSubMap:X,handleClearSubMap:J,onClose:()=>E(!1)})]})})}export{we as default};
