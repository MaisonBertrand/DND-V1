import{r,G as C,j as e,w as ae,q as ce,u as oe,o as xe,C as me,J as ne,H as he,P as pe,Q as ue}from"./index-c208d5f4.js";import{d as X,f as be,a as ge,b as re,l as ie,c as L,e as je}from"./DMCombatView-ac5ce6fc.js";import"./manualCombat-33808f22.js";function ve({partyId:l,onMapUpdate:N}){const[m,S]=r.useState([]),[E,D]=r.useState("Campaign Map"),[v,O]=r.useState({width:15,height:10}),[c,y]=r.useState("grass"),[o,M]=r.useState("draw"),[b,u]=r.useState(!1),[t,P]=r.useState({x:0,y:0}),[g,I]=r.useState({}),[k,$]=r.useState(null),[H,U]=r.useState(!1),[A,R]=r.useState({});r.useEffect(()=>{T()},[l]),r.useEffect(()=>{const i=()=>{U(!1)};return document.addEventListener("mouseup",i),()=>{document.removeEventListener("mouseup",i)}},[]);const T=async()=>{try{const i=await C.loadMapFromDatabase(l);D(i.title),S(i.content),I(i.subMaps),O(i.size)}catch(i){console.error("Error loading map:",i);const n=C.loadMap(l);D(n.title),S(n.content),I(n.subMaps),O(n.size)}},a=C.getTileTypes(),x=async(i,n)=>{let h;if(o==="draw")h=C.updateMapTile(m,i,n,c);else if(o==="erase")h=C.updateMapTile(m,i,n,"empty");else if(o==="player"){R(p=>({...p,[`player_${Date.now()}`]:{x:i,y:n,name:"Player"}}));return}S(h);try{await C.saveMapToDatabase(l,{title:E,content:h,size:v,subMaps:g}),N&&N({title:E,content:h,size:v,subMaps:g})}catch(p){console.error("Error saving map:",p)}},f=(i,n,h)=>{h.preventDefault(),U(!0),x(i,n)},w=(i,n)=>{H&&x(i,n)},F=()=>{U(!1)},B=(i,n,h)=>{h.preventDefault(),P({x:i,y:n}),$(g[`${i}-${n}`]||C.initializeSubMap()),u(!0)},Q=()=>C.initializeSubMap(),W=(i,n)=>{o==="draw"?$(C.updateSubMapTile(k,i,n,c)):o==="erase"&&$(C.updateSubMapTile(k,i,n,"empty"))},ee=(i,n,h)=>{h.preventDefault(),U(!0),W(i,n)},se=(i,n)=>{H&&W(i,n)},G=()=>{I(C.saveSubMap(g,t.x,t.y,k)),u(!1)},te=()=>{$(Q())},J=(i,n)=>C.getTileHasSubMap(g,i,n),Y=i=>{R(n=>{const h={...n};return delete h[i],h})};return e.jsxs("div",{className:"fantasy-card",style:{userSelect:"none"},children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-100",children:"🗺️ Campaign Map"}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Click and drag to edit the map. Changes are saved automatically."})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[e.jsx("button",{onClick:()=>M("draw"),className:`px-3 py-1 rounded text-sm font-medium transition-colors ${o==="draw"?"bg-blue-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:"✏️ Draw"}),e.jsx("button",{onClick:()=>M("erase"),className:`px-3 py-1 rounded text-sm font-medium transition-colors ${o==="erase"?"bg-red-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:"🧽 Erase"}),e.jsx("button",{onClick:()=>M("player"),className:`px-3 py-1 rounded text-sm font-medium transition-colors ${o==="player"?"bg-purple-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:"👤 Player"})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-300 mb-2",children:"Tile Types:"}),e.jsx("div",{className:"grid grid-cols-6 gap-1 max-h-32 overflow-y-auto",children:Object.entries(a).map(([i,n])=>e.jsxs("button",{onClick:()=>y(i),className:`p-2 rounded text-xs transition-colors ${c===i?"bg-blue-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,title:n.name,children:[e.jsx("div",{className:"text-lg",children:n.symbol}),e.jsx("div",{className:"text-xs",children:n.name})]},i))})]}),e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"bg-slate-900 p-4 rounded-lg overflow-auto select-none",children:e.jsx("div",{className:"grid gap-0",style:{gridTemplateColumns:`repeat(${v.width}, 1fr)`,width:"fit-content"},children:m.map((i,n)=>i.map((h,p)=>{const V=a[h]||a.empty,_=J(p,n),Z=Object.values(A).find(q=>q.x===p&&q.y===n);return e.jsxs("div",{className:`w-8 h-8 border border-slate-600 cursor-pointer transition-colors relative select-none ${V.color}`,onClick:()=>x(p,n),onMouseDown:q=>f(p,n,q),onMouseEnter:()=>w(p,n),onMouseUp:F,onContextMenu:q=>B(p,n,q),title:`${V.name} at (${p}, ${n})`,children:[e.jsx("div",{className:"flex items-center justify-center w-full h-full text-xs",children:Z?e.jsx("span",{className:"text-blue-400 font-bold",children:"👤"}):V.symbol}),_&&e.jsx("div",{className:"absolute top-0 right-0 w-2 h-2 bg-purple-500 rounded-full"})]},`${p}-${n}`)}))})})}),Object.keys(A).length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-300 mb-2",children:"Player Positions:"}),e.jsx("div",{className:"space-y-1",children:Object.entries(A).map(([i,n])=>e.jsxs("div",{className:"flex items-center justify-between bg-slate-700 p-2 rounded",children:[e.jsxs("span",{className:"text-sm text-slate-300",children:[n.name," at (",n.x,", ",n.y,")"]}),e.jsx("button",{onClick:()=>Y(i),className:"text-red-400 hover:text-red-300 text-sm",children:"✕"})]},i))})]}),b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-slate-800 p-6 rounded-lg max-w-2xl w-full mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-100",children:["Sub-Map Editor - Tile (",t.x,", ",t.y,")"]}),e.jsx("button",{onClick:()=>u(!1),className:"text-slate-400 hover:text-slate-300",children:"✕"})]}),e.jsx("div",{className:"bg-slate-900 p-4 rounded-lg overflow-auto mb-4 select-none",children:e.jsx("div",{className:"grid grid-cols-8 gap-0 w-fit",children:k.map((i,n)=>i.map((h,p)=>{const V=a[h]||a.empty;return e.jsx("div",{className:`w-6 h-6 border border-slate-600 cursor-pointer transition-colors select-none ${V.color}`,onClick:()=>W(p,n),onMouseDown:_=>ee(p,n,_),onMouseEnter:()=>se(p,n),onMouseUp:F,title:`${V.name} at (${p}, ${n})`,children:e.jsx("div",{className:"flex items-center justify-center w-full h-full text-xs",children:V.symbol})},`sub-${p}-${n}`)}))})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:G,className:"bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300",children:"Save Sub-Map"}),e.jsx("button",{onClick:te,className:"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300",children:"Clear Sub-Map"}),e.jsx("button",{onClick:()=>u(!1),className:"bg-gradient-to-r from-slate-500 to-slate-600 hover:from-slate-600 hover:to-slate-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300",children:"Cancel"})]})]})})]})}function fe(){const[l,N]=r.useState("monsters"),[m,S]=r.useState(""),[E,D]=r.useState(null),v=[{id:"monsters",name:"🐉 Monsters",icon:"🐉"},{id:"items",name:"⚔️ Items",icon:"⚔️"},{id:"spells",name:"✨ Spells",icon:"✨"},{id:"npcs",name:"👤 NPCs",icon:"👤"}],O=()=>{if(!m.trim())switch(l){case"monsters":return X.monsters;case"items":return X.items;case"spells":return X.spells;case"npcs":return X.npcs;default:return[]}switch(l){case"monsters":return X.searchMonsters(m);case"items":return X.searchItems(m);case"spells":return X.searchSpells(m);case"npcs":return X.searchNPCs(m);default:return[]}},c=t=>e.jsxs("div",{className:"bg-slate-700 rounded-lg p-4 hover:bg-slate-600 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-100",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs bg-red-600 text-white px-2 py-1 rounded",children:t.cr}),e.jsx("span",{className:"text-xs bg-slate-600 text-slate-300 px-2 py-1 rounded",children:t.type})]})]}),e.jsx("p",{className:"text-slate-300 text-sm mb-3",children:t.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"HP: "}),e.jsx("span",{className:"text-slate-200",children:t.hp})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"AC: "}),e.jsx("span",{className:"text-slate-200",children:t.ac})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Speed: "}),e.jsx("span",{className:"text-slate-200",children:t.speed})]})]}),t.actions&&t.actions.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-300 mb-1",children:"Actions:"}),e.jsx("div",{className:"space-y-1",children:t.actions.slice(0,2).map((P,g)=>e.jsxs("div",{className:"text-xs text-slate-400",children:[e.jsxs("span",{className:"font-medium",children:[P.name,":"]})," ",P.damage]},g))})]})]},t.id),y=t=>e.jsxs("div",{className:"bg-slate-700 rounded-lg p-4 hover:bg-slate-600 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-100",children:t.name}),e.jsx("span",{className:"text-xs bg-slate-600 text-slate-300 px-2 py-1 rounded",children:t.rarity})]}),e.jsx("p",{className:"text-slate-300 text-sm mb-3",children:t.description}),e.jsxs("div",{className:"text-xs text-slate-400",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Type:"})," ",t.type]}),t.damage&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Damage:"})," ",t.damage]}),t.ac&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"AC Bonus:"})," ",t.ac]}),t.effect&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Effect:"})," ",t.effect]}),t.properties&&t.properties.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Properties:"})," ",t.properties.join(", ")]})]})]},t.id),o=t=>e.jsxs("div",{className:"bg-slate-700 rounded-lg p-4 hover:bg-slate-600 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-100",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs bg-purple-600 text-white px-2 py-1 rounded",children:["Level ",t.level]}),e.jsx("span",{className:"text-xs bg-slate-600 text-slate-300 px-2 py-1 rounded",children:t.school})]})]}),e.jsx("p",{className:"text-slate-300 text-sm mb-3",children:t.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Casting Time: "}),e.jsx("span",{className:"text-slate-200",children:t.castingTime})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Range: "}),e.jsx("span",{className:"text-slate-200",children:t.range})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Duration: "}),e.jsx("span",{className:"text-slate-200",children:t.duration})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Components: "}),e.jsx("span",{className:"text-slate-200",children:t.components.join(", ")})]})]}),(t.damage||t.healing)&&e.jsxs("div",{className:"mt-2 text-xs",children:[t.damage&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Damage: "}),e.jsx("span",{className:"text-slate-200",children:t.damage})]}),t.healing&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Healing: "}),e.jsx("span",{className:"text-slate-200",children:t.healing})]}),t.save&&e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-400",children:"Save: "}),e.jsx("span",{className:"text-slate-200",children:t.save})]})]})]},t.id),M=t=>e.jsxs("div",{className:"bg-slate-700 rounded-lg p-4 hover:bg-slate-600 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-100",children:t.name}),e.jsx("span",{className:"text-xs bg-slate-600 text-slate-300 px-2 py-1 rounded",children:t.type})]}),e.jsx("p",{className:"text-slate-300 text-sm mb-3",children:t.description}),e.jsxs("div",{className:"text-xs text-slate-400 space-y-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Occupation:"})," ",t.occupation]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Personality:"})," ",t.personality]}),t.inventory&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Inventory:"})," ",t.inventory.join(", ")]}),t.equipment&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Equipment:"})," ",t.equipment.join(", ")]}),t.knowledge&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Knowledge:"})," ",t.knowledge.join(", ")]})]})]},t.id),b=t=>{switch(l){case"monsters":return c(t);case"items":return y(t);case"spells":return o(t);case"npcs":return M(t);default:return null}},u=O();return e.jsxs("div",{className:"fantasy-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-100",children:"📚 DM Catalogs"}),e.jsx("button",{onClick:()=>{const t=u[Math.floor(Math.random()*u.length)];t&&D(t)},className:"bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300 text-sm",children:"🎲 Random"})]}),e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",value:m,onChange:t=>S(t.target.value),placeholder:`Search ${l}...`,className:"w-full bg-slate-800 border border-slate-600 text-slate-100 px-3 py-2 rounded-lg focus:border-slate-500 focus:outline-none"})}),e.jsx("div",{className:"flex space-x-1 mb-4",children:v.map(t=>e.jsxs("button",{onClick:()=>N(t.id),className:`flex-1 px-3 py-2 rounded-lg text-sm font-medium transition-colors ${l===t.id?"bg-blue-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:[t.icon," ",t.name.split(" ")[1]]},t.id))}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 max-h-96 overflow-y-auto",children:u.map(b)}),u.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsxs("p",{className:"text-slate-400",children:["No ",l," found matching your search."]})}),E&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-slate-800 p-6 rounded-lg max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-100",children:["Selected ",l.slice(0,-1)]}),e.jsx("button",{onClick:()=>D(null),className:"text-slate-400 hover:text-slate-300",children:"✕"})]}),b(E)]})})]})}function Ne({character:l,isOpen:N,onClose:m,onUpdate:S}){const[E,D]=r.useState([]),[v,O]=r.useState(""),[c,y]=r.useState([]),[o,M]=r.useState(""),[b,u]=r.useState(!1),[t,P]=r.useState("overview"),[g,I]=r.useState("all");r.useEffect(()=>{if(N){const a=X.initializeItems();D(a),y([]),O(""),M(""),I("all")}},[N]);const k=E.reduce((a,x)=>{const f=x.type||"Other";return a[f]||(a[f]=[]),a[f].push(x),a},{}),$=Object.keys(k).sort(),H=E.filter(a=>(g==="all"||a.type===g)&&(a.name.toLowerCase().includes(v.toLowerCase())||a.type.toLowerCase().includes(v.toLowerCase())||a.rarity.toLowerCase().includes(v.toLowerCase()))),U=a=>{y(x=>x.find(w=>w.id===a.id)?x.filter(w=>w.id!==a.id):[...x,a])},A=async()=>{if(c.length!==0){u(!0);try{const a=[...l.equipment||[],...c];await ae(l.id,{equipment:a}),S(),y([])}catch(a){console.error("Error adding items:",a)}finally{u(!1)}}},R=async a=>{u(!0);try{const x=l.equipment.filter((f,w)=>w!==a);await ae(l.id,{equipment:x}),S()}catch(x){console.error("Error removing item:",x)}finally{u(!1)}},T=async()=>{const a=parseInt(o);if(!(isNaN(a)||a<=0)){u(!0);try{const f=(l.xp||0)+a,w={...l,xp:f},F=ie.shouldLevelUp(w);if(await ae(l.id,{xp:f}),S(),M(""),F){const B=ie.getLevelUpInfo(w);alert(`${l.name} has leveled up to level ${B.newLevel}! They should complete their level-up choices.`)}}catch(x){console.error("Error adding XP:",x)}finally{u(!1)}}};return!N||!l?null:e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-slate-800/50 border border-slate-600/50 rounded-lg p-6 shadow-lg backdrop-blur-sm max-w-6xl w-full max-h-[95vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-amber-400 to-orange-400",children:["Manage ",l.name,"'s Inventory"]}),e.jsx("button",{onClick:m,className:"text-slate-400 hover:text-slate-200 text-2xl font-bold",children:"×"})]}),e.jsxs("div",{className:"flex border-b border-slate-600 mb-6",children:[e.jsx("button",{onClick:()=>P("overview"),className:`px-4 py-2 font-medium transition-colors ${t==="overview"?"text-amber-400 border-b-2 border-amber-400":"text-slate-400 hover:text-slate-300"}`,children:"📊 Overview"}),e.jsx("button",{onClick:()=>P("add-items"),className:`px-4 py-2 font-medium transition-colors ${t==="add-items"?"text-amber-400 border-b-2 border-amber-400":"text-slate-400 hover:text-slate-300"}`,children:"➕ Add Items"}),e.jsx("button",{onClick:()=>P("xp"),className:`px-4 py-2 font-medium transition-colors ${t==="xp"?"text-amber-400 border-b-2 border-amber-400":"text-slate-400 hover:text-slate-300"}`,children:"⭐ Experience"})]}),e.jsxs("div",{className:"space-y-6",children:[t==="overview"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Character Stats"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-slate-700/30 rounded p-3",children:[e.jsx("div",{className:"text-xs text-slate-400",children:"Level"}),e.jsx("div",{className:"text-lg font-bold text-slate-200",children:l.level})]}),e.jsxs("div",{className:"bg-slate-700/30 rounded p-3",children:[e.jsx("div",{className:"text-xs text-slate-400",children:"XP"}),e.jsx("div",{className:"text-lg font-bold text-slate-200",children:l.xp||0})]}),e.jsxs("div",{className:"bg-slate-700/30 rounded p-3",children:[e.jsx("div",{className:"text-xs text-slate-400",children:"HP"}),e.jsxs("div",{className:"text-lg font-bold text-slate-200",children:[l.hp,"/",l.maxHp]})]}),e.jsxs("div",{className:"bg-slate-700/30 rounded p-3",children:[e.jsx("div",{className:"text-xs text-slate-400",children:"AC"}),e.jsx("div",{className:"text-lg font-bold text-slate-200",children:l.ac})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-slate-200",children:"Ability Scores"}),e.jsx("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[{name:"STR",score:l.strength},{name:"DEX",score:l.dexterity},{name:"CON",score:l.constitution},{name:"INT",score:l.intelligence},{name:"WIS",score:l.wisdom},{name:"CHA",score:l.charisma}].map(a=>e.jsxs("div",{className:"bg-slate-700/30 rounded p-2 text-center",children:[e.jsx("div",{className:"text-xs text-slate-400",children:a.name}),e.jsx("div",{className:"font-bold text-slate-200",children:a.score}),e.jsx("div",{className:"text-xs text-slate-300",children:be(ge(a.score))})]},a.name))})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Current Equipment"}),l.equipment&&l.equipment.length>0?e.jsx("div",{className:"space-y-2",children:l.equipment.map((a,x)=>e.jsxs("div",{className:"bg-slate-700/30 rounded p-3 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-200",children:a.name}),e.jsxs("div",{className:"text-sm text-slate-400",children:[a.type," • ",e.jsx("span",{className:re(a.rarity),children:a.rarity})]})]}),e.jsx("button",{onClick:()=>R(x),disabled:b,className:"text-red-400 hover:text-red-300 text-sm font-medium disabled:opacity-50",children:"Remove"})]},x))}):e.jsx("p",{className:"text-slate-400",children:"No equipment found."})]})]}),t==="add-items"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4 mb-4",children:[e.jsx("input",{type:"text",placeholder:"Search items...",value:v,onChange:a=>O(a.target.value),className:"flex-1 bg-slate-700/50 border border-slate-600 rounded px-3 py-2 text-slate-200 placeholder-slate-400"}),e.jsxs("select",{value:g,onChange:a=>I(a.target.value),className:"bg-slate-700/50 border border-slate-600 rounded px-3 py-2 text-slate-200",children:[e.jsx("option",{value:"all",children:"All Categories"}),$.map(a=>e.jsx("option",{value:a,children:a},a))]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-96 overflow-y-auto",children:H.map(a=>e.jsxs("div",{onClick:()=>U(a),className:`bg-slate-700/30 rounded p-3 cursor-pointer transition-colors ${c.find(x=>x.id===a.id)?"ring-2 ring-amber-400 bg-amber-900/20":"hover:bg-slate-700/50"}`,children:[e.jsx("div",{className:"font-medium text-slate-200",children:a.name}),e.jsxs("div",{className:"text-sm text-slate-400",children:[a.type," • ",e.jsx("span",{className:re(a.rarity),children:a.rarity})]}),a.description&&e.jsx("div",{className:"text-sm text-slate-300 mt-2 line-clamp-2",children:a.description})]},a.id))}),c.length>0&&e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:A,disabled:b,className:"bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300 disabled:opacity-50",children:b?"Adding...":`Add ${c.length} Item${c.length>1?"s":""}`}),e.jsx("button",{onClick:()=>y([]),className:"bg-gradient-to-r from-slate-500 to-slate-600 hover:from-slate-600 hover:to-slate-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300",children:"Clear Selection"})]})]}),t==="xp"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100",children:"Add Experience Points"}),e.jsx("div",{className:"bg-slate-700/30 rounded p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:["Current XP: ",l.xp||0]}),e.jsx("input",{type:"number",placeholder:"Enter XP to add...",value:o,onChange:a=>M(a.target.value),className:"w-full bg-slate-700/50 border border-slate-600 rounded px-3 py-2 text-slate-200 placeholder-slate-400"})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:T,disabled:b||!o||parseInt(o)<=0,className:"bg-gradient-to-r from-amber-500 to-amber-600 hover:from-amber-600 hover:to-amber-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300 disabled:opacity-50",children:b?"Adding...":"Add XP"})})]})})]})]})]})})}function Se(){var _,Z,q,le;const{partyId:l}=ce(),N=oe(),[m,S]=r.useState(null),[E,D]=r.useState(!0),[v,O]=r.useState(null),[c,y]=r.useState([]),[o,M]=r.useState("map");r.useState("");const[b,u]=r.useState(""),[t,P]=r.useState(""),[g,I]=r.useState([]),[k,$]=r.useState([]),[H,U]=r.useState(""),[A,R]=r.useState(""),[T,a]=r.useState("hidden");r.useState(!1);const[x,f]=r.useState(null),[w,F]=r.useState(!1),B=r.useMemo(()=>[{id:"map",name:"🗺️ Campaign Map",icon:"🗺️",description:"Primary campaign map and player view control"},{id:"scene",name:"🎭 Scene Manager",icon:"🎭",description:"Manage current scene and objectives"},{id:"players",name:"👥 Player Information",icon:"👥",description:"View player characters and stats"},{id:"combat",name:"⚔️ Combat Planning",icon:"⚔️",description:"Enemy selection, initiative, and combat management"},{id:"npcs",name:"🤝 NPC Manager",icon:"🤝",description:"Non-player characters and dialogue"},{id:"notes",name:"📝 Campaign Notes",icon:"📝",description:"Session notes and story tracking"}],[]),Q=r.useMemo(()=>[{id:"map",name:"🗺️ Campaign Map",description:"Players see the main campaign map"},{id:"scene",name:"🎭 Current Scene",description:"Players see the current scene description"},{id:"combat",name:"⚔️ Combat View",description:"Players see combat initiative and status"},{id:"hidden",name:"👻 Hidden",description:"Players see a loading screen"}],[]),W=r.useMemo(()=>{const s=c.reduce((j,z)=>j+(z.hp||0),0),d=c.reduce((j,z)=>j+(z.maxHp||0),0);return{current:s,max:d}},[c]),ee=r.useCallback(s=>{L.updatePlayerView(l,"combat")},[l]);r.useEffect(()=>{const s=xe(d=>{if(!d){N("/login");return}S(d)});return()=>s()},[N]),r.useEffect(()=>{m&&l&&G()},[m,l]),r.useEffect(()=>{if(!m||!l)return;const s=L.listenToPlayerView(l,d=>{a(d)});return()=>{s&&s()}},[m==null?void 0:m.uid,l]);const se=async s=>{if(!s)throw new Error("Party not found");if(!s.members||!Array.isArray(s.members))throw new Error("Invalid party data: missing members array");if(!s.members.includes(m.uid))throw new Error("You are not a member of this party");return s.dmId!==m.uid?(console.log("User is not DM, redirecting to player view"),N(`/manual-campaign/${l}`),!1):(console.log("User permissions verified successfully"),!0)},G=async()=>{try{D(!0),console.log("Loading campaign data for partyId:",l),console.log("Current user:",m);const s=await me(l);if(console.log("Party data loaded:",s),O(s),!await se(s))return;console.log("User is DM, loading party characters...");try{const K=await ne(l);console.log("Party characters loaded:",K),y(K)}catch(K){console.error("Failed to load party characters:",K),y([]),alert("Warning: Unable to load party characters. The DM interface may have limited functionality.")}let j=await he(l);if(j)console.log("Found existing campaign story:",j);else try{console.log("Creating new campaign story for manual campaign..."),j=await pe(l),console.log("Successfully created new campaign story:",j)}catch(K){console.error("Error creating campaign story:",K),alert("Warning: Unable to create campaign story. Some features may not work properly. Please try refreshing the page.")}const z=await L.getCurrentScene(l);z&&(u(z.title),P(z.description),I(z.objectives||[]),$(z.problems||[]));const de=await L.getPlayerView(l);a(de)}catch(s){console.error("Error loading campaign data:",s),console.error("Error details:",{code:s.code,message:s.message,stack:s.stack}),alert(`Error loading campaign data: ${s.message}`)}finally{D(!1)}},te=async()=>{try{if(!b.trim()||!t.trim()){alert("Please provide both title and description for the scene.");return}const s={title:b,description:t,mapLocation:{x:0,y:0},objectives:g,problems:k};await L.createScene(l,s),alert("Scene created successfully!")}catch(s){console.error("Error creating scene:",s),alert("Failed to create scene")}},J=async()=>{if(H.trim())try{const s=await L.getCurrentScene(l);if(!s){alert("Please create a scene first.");return}await L.addObjective(l,s.id,H),I([...g,{id:`obj_${Date.now()}`,text:H,completed:!1}]),U("")}catch(s){console.error("Error adding objective:",s)}},Y=async()=>{if(A.trim())try{const s=await L.getCurrentScene(l);if(!s){alert("Please create a scene first.");return}await L.addProblem(l,s.id,A),$([...k,{id:`prob_${Date.now()}`,text:A,solved:!1}]),R("")}catch(s){console.error("Error adding problem:",s)}},i=s=>{},n=async s=>{try{a(s),await L.updatePlayerView(l,s)}catch(d){console.error("Error updating player view:",d)}},h=s=>{f(s),F(!0)},p=()=>{F(!1),f(null)},V=()=>{G()};return E?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:e.jsx("div",{className:"fantasy-container py-8",children:e.jsx("div",{className:"fantasy-card",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-amber-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-300",children:"Loading DM Campaign..."})]})})})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:[e.jsxs("div",{className:"fantasy-container py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h1",{className:"text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-amber-400 to-orange-400 mb-4",children:"DM Campaign Control"}),e.jsx("div",{className:"w-24 h-1 bg-gradient-to-r from-amber-400 to-orange-400 mx-auto rounded-full mb-4"}),e.jsx("h2",{className:"text-2xl font-semibold text-slate-100 mb-2",children:v==null?void 0:v.name}),e.jsx("p",{className:"text-slate-400 mb-4",children:"Manual Campaign - Dungeon Master Interface"}),e.jsxs("div",{className:"flex items-center justify-center space-x-4 mb-4",children:[e.jsx("div",{className:"px-3 py-1 rounded-full text-sm font-medium bg-slate-600/20 text-slate-300 border border-slate-500/30",children:"👑 Dungeon Master"}),e.jsxs("div",{className:"text-slate-400",children:[c.length," Players"]})]}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:"bg-slate-700/50 border border-slate-600/50 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-sm text-slate-300",children:"Player View:"}),T==="hidden"?e.jsx("button",{onClick:()=>n("map"),className:"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white px-4 py-2 rounded-lg transition-all duration-300 text-sm font-medium",children:"👁️ Show Players"}):e.jsx("button",{onClick:()=>n("hidden"),className:"bg-gradient-to-r from-slate-600 to-slate-700 hover:from-slate-700 hover:to-slate-800 text-white px-4 py-2 rounded-lg transition-all duration-300 text-sm font-medium",children:"👻 Hide from Players"}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${T==="hidden"?"bg-red-600/20 text-red-300 border border-red-500/30":"bg-green-600/20 text-green-300 border border-green-500/30"}`,children:(_=Q.find(s=>s.id===T))==null?void 0:_.name})]})})})]})}),e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"w-full max-w-6xl",children:[o==="map"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"fantasy-card",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-100",children:"🗺️ Campaign Map"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-sm text-slate-400",children:[e.jsx("span",{className:"text-blue-400 font-semibold",children:c.length})," Players"]}),e.jsxs("div",{className:"text-sm text-slate-400",children:["Scene: ",e.jsx("span",{className:"text-green-400 font-semibold",children:b||"None"})]}),e.jsxs("div",{className:"text-sm text-slate-400",children:["View: ",e.jsx("span",{className:"text-amber-400 font-semibold",children:(Z=Q.find(s=>s.id===T))==null?void 0:Z.name})]})]})]})}),e.jsx("div",{className:"fantasy-card",children:e.jsx(ve,{partyId:l,onMapUpdate:i})})]}),o==="players"&&e.jsxs("div",{className:"fantasy-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-100",children:"👥 Player Information"}),e.jsx("button",{onClick:async()=>{try{const s=await ue(l);alert(`Fixed ability scores for ${s.fixedCount} out of ${s.totalCharacters} characters.`);const d=await ne(l);y(d)}catch(s){console.error("Error fixing character ability scores:",s),alert("Failed to fix character ability scores. Please try again.")}},className:"px-3 py-1 bg-amber-600 hover:bg-amber-500 text-white rounded text-sm transition-colors",title:"Fix character ability scores if they appear incorrect",children:"🔧 Fix Stats"})]}),e.jsxs("div",{className:"mb-6 p-4 bg-slate-800/50 rounded-lg border border-slate-600/50",children:[e.jsx("h4",{className:"text-lg font-semibold text-slate-200 mb-3",children:"📊 Party Summary"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:c.length}),e.jsx("div",{className:"text-xs text-slate-400",children:"Players"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-400",children:[c.reduce((s,d)=>s+(d.hp||0),0),"/",c.reduce((s,d)=>s+(d.maxHp||0),0)]}),e.jsx("div",{className:"text-xs text-slate-400",children:"Total HP"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-400",children:c.filter(s=>s.spells&&s.spells.length>0).length}),e.jsx("div",{className:"text-xs text-slate-400",children:"Spellcasters"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-amber-400",children:c.reduce((s,d)=>s+(d.level||1),0)}),e.jsx("div",{className:"text-xs text-slate-400",children:"Total Levels"})]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-600/50",children:[e.jsx("h5",{className:"text-sm font-semibold text-slate-300 mb-2",children:"Class Distribution"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(c.reduce((s,d)=>(s[d.class]=(s[d.class]||0)+1,s),{})).map(([s,d])=>e.jsxs("span",{className:"px-3 py-1 bg-slate-700 text-slate-200 text-xs rounded-full border border-slate-600",children:[s,": ",d]},s))})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:c.map(s=>e.jsxs("div",{className:"bg-slate-700/50 p-6 rounded-lg border border-slate-600/50 hover:border-slate-500/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 pb-4 border-b border-slate-600/50",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-bold text-slate-100",children:s.name}),e.jsxs("p",{className:"text-slate-400 text-sm",children:[s.race," ",s.class," • Level ",s.level]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold text-red-400",children:[s.hp,"/",s.maxHp," HP"]}),e.jsxs("div",{className:"text-sm text-slate-400",children:["AC: ",s.ac||"N/A"]})]})]}),e.jsx("div",{className:"mb-4",children:e.jsx("button",{onClick:()=>h(s),className:"w-full bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300",children:"📦 Manage Inventory & Spells"})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h5",{className:"text-sm font-semibold text-slate-300 mb-2",children:"Ability Scores"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[e.jsxs("div",{className:"bg-slate-800 p-2 rounded text-center",children:[e.jsx("div",{className:"font-bold text-red-400",children:"STR"}),e.jsx("div",{className:"text-slate-300",children:s.strength})]}),e.jsxs("div",{className:"bg-slate-800 p-2 rounded text-center",children:[e.jsx("div",{className:"font-bold text-blue-400",children:"DEX"}),e.jsx("div",{className:"text-slate-300",children:s.dexterity})]}),e.jsxs("div",{className:"bg-slate-800 p-2 rounded text-center",children:[e.jsx("div",{className:"font-bold text-green-400",children:"CON"}),e.jsx("div",{className:"text-slate-300",children:s.constitution})]}),e.jsxs("div",{className:"bg-slate-800 p-2 rounded text-center",children:[e.jsx("div",{className:"font-bold text-purple-400",children:"INT"}),e.jsx("div",{className:"text-slate-300",children:s.intelligence})]}),e.jsxs("div",{className:"bg-slate-800 p-2 rounded text-center",children:[e.jsx("div",{className:"font-bold text-yellow-400",children:"WIS"}),e.jsx("div",{className:"text-slate-300",children:s.wisdom})]}),e.jsxs("div",{className:"bg-slate-800 p-2 rounded text-center",children:[e.jsx("div",{className:"font-bold text-pink-400",children:"CHA"}),e.jsx("div",{className:"text-slate-300",children:s.charisma})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-slate-300 mb-2",children:"Equipment"}),e.jsxs("div",{className:"text-xs text-slate-400 space-y-1",children:[e.jsxs("div",{children:["Weapon: ",s.weapon||"None"]}),e.jsxs("div",{children:["Armor: ",s.armor||"None"]}),e.jsxs("div",{children:["Shield: ",s.shield||"None"]}),e.jsxs("div",{children:["Spells: ",s.spells?s.spells.length:0," known"]})]})]})]},s.id))})]}),o==="scene"&&e.jsxs("div",{className:"fantasy-card",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-100 mb-4",children:"🎭 Scene Manager"}),e.jsxs("div",{className:"mb-6 p-4 bg-slate-800/50 rounded-lg border border-slate-600/50",children:[e.jsx("h4",{className:"text-lg font-semibold text-slate-200 mb-3",children:"Current Scene"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Scene Title"}),e.jsx("input",{type:"text",value:b,onChange:s=>u(s.target.value),className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-slate-200 focus:outline-none focus:border-blue-500",placeholder:"Enter scene title..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1",children:"Scene Description"}),e.jsx("textarea",{value:t,onChange:s=>P(s.target.value),rows:4,className:"w-full bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-slate-200 focus:outline-none focus:border-blue-500",placeholder:"Describe the current scene..."})]}),e.jsx("button",{onClick:te,className:"bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300",children:"🎭 Create/Update Scene"})]})]}),e.jsxs("div",{className:"mb-6 p-4 bg-slate-800/50 rounded-lg border border-slate-600/50",children:[e.jsx("h4",{className:"text-lg font-semibold text-slate-200 mb-3",children:"Objectives"}),e.jsx("div",{className:"space-y-2 mb-3",children:g.map((s,d)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-slate-700 rounded",children:[e.jsx("input",{type:"checkbox",checked:s.completed,onChange:()=>{const j=[...g];j[d].completed=!j[d].completed,I(j)},className:"text-green-500"}),e.jsx("span",{className:`flex-1 text-sm ${s.completed?"line-through text-slate-500":"text-slate-300"}`,children:s.text})]},d))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:H,onChange:s=>U(s.target.value),onKeyPress:s=>s.key==="Enter"&&J(),className:"flex-1 bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-slate-200 focus:outline-none focus:border-blue-500",placeholder:"Add new objective..."}),e.jsx("button",{onClick:J,className:"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300",children:"Add"})]})]}),e.jsxs("div",{className:"p-4 bg-slate-800/50 rounded-lg border border-slate-600/50",children:[e.jsx("h4",{className:"text-lg font-semibold text-slate-200 mb-3",children:"Problems"}),e.jsx("div",{className:"space-y-2 mb-3",children:k.map((s,d)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-slate-700 rounded",children:[e.jsx("input",{type:"checkbox",checked:s.solved,onChange:()=>{const j=[...k];j[d].solved=!j[d].solved,$(j)},className:"text-green-500"}),e.jsx("span",{className:`flex-1 text-sm ${s.solved?"line-through text-slate-500":"text-slate-300"}`,children:s.text})]},d))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:A,onChange:s=>R(s.target.value),onKeyPress:s=>s.key==="Enter"&&Y(),className:"flex-1 bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-slate-200 focus:outline-none focus:border-blue-500",placeholder:"Add new problem..."}),e.jsx("button",{onClick:Y,className:"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-300",children:"Add"})]})]})]}),o==="combat"&&e.jsx(je,{partyId:l,partyCharacters:c,onCombatStart:ee}),o==="npcs"&&e.jsxs("div",{className:"fantasy-card",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-100 mb-4",children:"🤝 NPC Manager"}),e.jsx("p",{className:"text-slate-400 mb-4",children:"Non-player characters and dialogue management coming soon..."}),e.jsxs("div",{className:"bg-slate-700/50 p-6 rounded-lg text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"🤝"}),e.jsx("h4",{className:"text-lg font-semibold text-slate-200 mb-2",children:"NPC Manager"}),e.jsx("p",{className:"text-slate-400",children:"Create and manage NPCs with dialogue trees"})]})]}),o==="notes"&&e.jsxs("div",{className:"fantasy-card",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-100 mb-4",children:"📝 Campaign Notes"}),e.jsx("p",{className:"text-slate-400 mb-4",children:"Session notes and story tracking coming soon..."}),e.jsxs("div",{className:"bg-slate-700/50 p-6 rounded-lg text-center",children:[e.jsx("div",{className:"text-4xl mb-4",children:"📝"}),e.jsx("h4",{className:"text-lg font-semibold text-slate-200 mb-2",children:"Campaign Notes"}),e.jsx("p",{className:"text-slate-400",children:"Track session notes and story progression"})]})]}),o==="catalogs"&&e.jsx(fe,{})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"fantasy-card bg-slate-800/50",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-100 mb-4 border-b border-slate-600 pb-2",children:"👥 Player View Control"}),e.jsxs("div",{className:"p-3 bg-slate-700/30 rounded-lg border border-slate-600/50",children:[e.jsx("div",{className:"mb-2",children:e.jsx("h4",{className:"text-sm font-semibold text-slate-200",children:"Current View"})}),e.jsx("div",{className:"text-xs text-slate-400 mb-3",children:(q=Q.find(s=>s.id===T))==null?void 0:q.name}),e.jsx("div",{className:"space-y-1",children:Q.map(s=>e.jsxs("button",{onClick:()=>n(s.id),className:`w-full text-left p-2 rounded text-xs transition-colors ${T===s.id?"bg-blue-600 text-white":"bg-slate-600/50 hover:bg-slate-500/50 text-slate-300"}`,children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsx("div",{className:"text-xs opacity-75",children:s.description})]},s.id))})]})]}),e.jsxs("div",{className:"fantasy-card bg-slate-800/50",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-100 mb-4 border-b border-slate-600 pb-2",children:"🎯 DM Tools"}),e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:B.map(s=>e.jsx("button",{onClick:()=>M(s.id),className:`w-full text-left p-3 rounded-lg transition-all duration-200 group ${o===s.id?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg":"bg-slate-700/50 hover:bg-slate-600/50 text-slate-300 hover:text-white"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xl",children:s.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-sm",children:s.name.split(" ").slice(1).join(" ")}),e.jsx("div",{className:`text-xs mt-1 ${o===s.id?"text-blue-100":"text-slate-400"}`,children:s.description})]})]})},s.id))})]}),e.jsxs("div",{className:"fantasy-card bg-slate-800/50",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-100 mb-4 border-b border-slate-600 pb-2",children:"📊 Quick Stats"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-slate-700/30 rounded-lg",children:[e.jsx("div",{className:"text-sm text-slate-400",children:"Players"}),e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:c.length})]}),e.jsxs("div",{className:"p-3 bg-slate-700/30 rounded-lg",children:[e.jsx("div",{className:"text-sm text-slate-400",children:"Total HP"}),e.jsxs("div",{className:"text-2xl font-bold text-green-400",children:[W.current,"/",W.max]})]}),e.jsxs("div",{className:"p-3 bg-slate-700/30 rounded-lg",children:[e.jsx("div",{className:"text-sm text-slate-400",children:"Current Scene"}),e.jsx("div",{className:"text-lg font-bold text-amber-400",children:b||"None"})]}),e.jsxs("div",{className:"p-3 bg-slate-700/30 rounded-lg",children:[e.jsx("div",{className:"text-sm text-slate-400",children:"Player View"}),e.jsx("div",{className:"text-lg font-bold text-purple-400",children:(le=Q.find(s=>s.id===T))==null?void 0:le.name})]})]})]})]})]})]}),x&&e.jsx(Ne,{character:x,isOpen:w,onClose:p,onUpdate:V})]})}export{Se as default};
